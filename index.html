<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ModelFlex Application</title>
    <!-- Tailwind CSS for styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- React Libraries -->
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <!-- Babel to transpile JSX in the browser -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
</head>
<body>
    <!-- This is the root div where your React application will be mounted. -->
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // Mock Data - In a real app, this would come from a backend API
        const mockVendors = [
          { id: 'v1', name: 'Dr. Alice Smith', company: 'Philips Healthcare', email: 'alice@philips.com', jobTitle: 'Clinical Marketing Manager' },
          { id: 'v2', name: 'Bob Johnson', company: 'GE HealthCare', email: 'bob@ge.com', jobTitle: 'Sonography Lead' },
        ];

        const mockModels = [
          { id: 'm1', name: 'Charlie Brown', email: 'charlie@email.com', phone: '555-1234', hasTransportation: true, available: true },
          { id: 'm2', name: 'Diana Prince', email: 'diana@email.com', phone: '555-5678', hasTransportation: true, available: true },
          { id: 'm3', name: 'Eve Adams', email: 'eve@email.com', phone: '555-8765', hasTransportation: true, available: false },
        ];

        const mockAppointments = [
          { id: 'a1', vendorId: 'v1', modelId: 'm1', date: '2025-09-15', time: '10:00', duration: 2, application: 'Abdomen', status: 'confirmed' },
          { id: 'a2', vendorId: 'v2', modelId: 'm2', date: '2025-09-15', time: '14:00', duration: 1, application: 'Vascular', status: 'pending' },
          { id: 'a3', vendorId: 'v1', modelId: 'm3', date: '2025-09-16', time: '11:00', duration: 1.5, application: 'Breast', status: 'rejected' },
        ];

        const mockLogs = [
            { id: 'l1', timestamp: '2025-09-10 09:05:12', action: 'INVITE_SENT', details: 'Vendor v1 invited Model m2 for appointment a2' },
            { id: 'l2', timestamp: '2025-09-11 15:30:00', action: 'INVITE_ACCEPTED', details: 'Model m1 accepted appointment a1' },
            { id: 'l3', timestamp: '2025-09-12 11:00:45', action: 'USER_CREATED', details: 'Model m3 registered.' },
        ];


        // Helper Components
        const Card = ({ children, className }) => (
          <div className={`bg-white rounded-xl shadow-md p-6 ${className}`}>
            {children}
          </div>
        );

        const Button = ({ children, onClick, className = 'bg-blue-600 hover:bg-blue-700', type = 'button', disabled = false }) => (
          <button
            type={type}
            onClick={onClick}
            disabled={disabled}
            className={`flex items-center justify-center text-white font-bold py-2 px-4 rounded-lg transition duration-300 ease-in-out transform hover:scale-105 ${className} ${disabled ? 'opacity-50 cursor-not-allowed' : ''}`}
          >
            {children}
          </button>
        );

        const Input = ({ id, label, type = 'text', value, onChange, placeholder }) => (
          <div>
            <label htmlFor={id} className="block text-sm font-medium text-gray-700 mb-1">{label}</label>
            <input
              type={type}
              id={id}
              name={id}
              value={value}
              onChange={onChange}
              placeholder={placeholder}
              className="w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500"
            />
          </div>
        );

        const Select = ({ id, label, value, onChange, children }) => (
            <div>
                <label htmlFor={id} className="block text-sm font-medium text-gray-700 mb-1">{label}</label>
                <select
                    id={id}
                    value={value}
                    onChange={onChange}
                    className="w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white"
                >
                    {children}
                </select>
            </div>
        );

        const Spinner = () => (
            <div className="animate-spin rounded-full h-5 w-5 border-b-2 border-white"></div>
        );

        // Main App Component
        function App() {
          const [user, setUser] = useState(null);
          const [page, setPage] = useState('login');

          const handleLogin = (role) => {
            setUser({ role, name: `Test ${role.charAt(0).toUpperCase() + role.slice(1)}` });
            setPage('dashboard');
          };

          const handleLogout = () => {
            setUser(null);
            setPage('login');
          };

          const renderContent = () => {
            if (page === 'login') {
              return <LoginPage onLogin={handleLogin} onSwitchToRegister={() => setPage('register')} />;
            }
            if (page === 'register') {
                return <RegisterPage onRegister={handleLogin} onSwitchToLogin={() => setPage('login')} />;
            }
            if (page === 'dashboard' && user) {
              switch (user.role) {
                case 'admin':
                  return <AdminDashboard user={user} onLogout={handleLogout} />;
                case 'vendor':
                  return <VendorDashboard user={user} onLogout={handleLogout} />;
                case 'model':
                  return <ModelDashboard user={user} onLogout={handleLogout} />;
                default:
                  return <p>Unknown role.</p>;
              }
            }
            return <LoginPage onLogin={handleLogin} onSwitchToRegister={() => setPage('register')} />;
          };

          return (
            <div className="bg-gray-50 min-h-screen font-sans">
              {renderContent()}
            </div>
          );
        }

        // Login & Register Pages
        const LoginPage = ({ onLogin, onSwitchToRegister }) => {
          return (
            <div className="flex items-center justify-center min-h-screen">
              <Card className="w-full max-w-md">
                <div className="text-center">
                  <h1 className="text-3xl font-bold text-gray-800">ModelFlex</h1>
                  <p className="text-gray-600 mt-2">Connecting Innovators with Participants</p>
                </div>
                <div className="mt-8 space-y-4">
                  <Input id="email" label="Email Address" placeholder="you@example.com" onChange={() => {}}/>
                  <Input id="password" label="Password" type="password" onChange={() => {}}/>
                  <Button onClick={() => {}} className="w-full bg-blue-600 hover:bg-blue-700">Login</Button>
                  <p className="text-center text-sm text-gray-500">
                    Forgot password?
                  </p>
                  <hr/>
                  <p className="text-center text-sm font-semibold text-gray-700">Login as a demo user:</p>
                  <div className="flex justify-center space-x-2">
                    <Button onClick={() => onLogin('admin')} className="bg-red-600 hover:bg-red-700 text-xs">Admin</Button>
                    <Button onClick={() => onLogin('vendor')} className="bg-green-600 hover:bg-green-700 text-xs">Vendor</Button>
                    <Button onClick={() => onLogin('model')} className="bg-yellow-500 hover:bg-yellow-600 text-xs">Model</Button>
                  </div>
                </div>
                 <p className="mt-6 text-center text-sm text-gray-500">
                    Don't have an account?{' '}
                    <button onClick={onSwitchToRegister} className="font-medium text-blue-600 hover:text-blue-500">
                      Register here
                    </button>
                  </p>
              </Card>
            </div>
          );
        };

        const RegisterPage = ({ onRegister, onSwitchToLogin }) => {
            const [role, setRole] = useState('model');

            return (
                <div className="flex items-center justify-center min-h-screen py-12">
                    <Card className="w-full max-w-lg">
                        <h2 className="text-2xl font-bold text-center text-gray-800">Create Your Account</h2>
                        <div className="mt-6">
                            <Select id="role" label="I am a..." value={role} onChange={(e) => setRole(e.target.value)}>
                                <option value="model">Model / Participant</option>
                                <option value="vendor">Vendor</option>
                            </Select>
                        </div>
                        <div className="mt-4 space-y-4">
                            <Input id="name" label="Full Name" placeholder="John Doe" onChange={() => {}}/>
                            <Input id="email" label="Email Address" placeholder="you@example.com" onChange={() => {}}/>
                            <Input id="phone" label="Phone Number" placeholder="555-555-5555" onChange={() => {}}/>
                            <Input id="password" label="Password" type="password" onChange={() => {}}/>
                            <Input id="confirmPassword" label="Confirm Password" type="password" onChange={() => {}}/>

                            {role === 'vendor' && (
                                <>
                                    <Input id="company" label="Company Name" placeholder="Your Company Inc." onChange={() => {}}/>
                                    <Input id="jobTitle" label="Job Title" placeholder="Clinical Manager" onChange={() => {}}/>
                                </>
                            )}
                            
                            {role === 'model' && (
                                <div className="flex items-start">
                                    <div className="flex items-center h-5">
                                        <input id="transportation" name="transportation" type="checkbox" className="focus:ring-blue-500 h-4 w-4 text-blue-600 border-gray-300 rounded" />
                                    </div>
                                    <div className="ml-3 text-sm">
                                        <label htmlFor="transportation" className="font-medium text-gray-700">I have my own transportation</label>
                                    </div>
                                </div>
                            )}

                            <Button onClick={() => onRegister(role)} className="w-full bg-blue-600 hover:bg-blue-700">Register</Button>
                        </div>
                        <p className="mt-6 text-center text-sm text-gray-500">
                            Already have an account?{' '}
                            <button onClick={onSwitchToLogin} className="font-medium text-blue-600 hover:text-blue-500">
                              Log in
                            </button>
                        </p>
                    </Card>
                </div>
            );
        };


        // Dashboard Layout
        const DashboardLayout = ({ user, onLogout, children, activeTab, onTabChange, tabs }) => {
          return (
            <div className="flex h-screen bg-gray-100">
              <div className="w-64 bg-white shadow-lg flex flex-col">
                <div className="p-6 text-2xl font-bold text-gray-800 border-b">
                  ModelFlex
                </div>
                <nav className="flex-1 px-4 py-6 space-y-2">
                  {tabs.map(tab => (
                    <button
                      key={tab.id}
                      onClick={() => onTabChange(tab.id)}
                      className={`w-full flex items-center px-4 py-2 text-left text-gray-600 rounded-lg transition-colors duration-200 ${
                        activeTab === tab.id
                          ? 'bg-blue-100 text-blue-700'
                          : 'hover:bg-gray-100'
                      }`}
                    >
                      <span className="w-5 h-5">{tab.icon}</span>
                      <span className="ml-3">{tab.name}</span>
                    </button>
                  ))}
                </nav>
                <div className="p-4 border-t">
                   <button
                      onClick={() => {}}
                      className="w-full flex items-center px-4 py-2 text-left text-gray-600 rounded-lg hover:bg-gray-100"
                    >
                      <span className="w-5 h-5">⚙️</span>
                      <span className="ml-3">Settings</span>
                    </button>
                  <button
                    onClick={onLogout}
                    className="w-full flex items-center px-4 py-2 mt-2 text-left text-red-600 rounded-lg hover:bg-red-50"
                  >
                    <span className="w-5 h-5">🚪</span>
                    <span className="ml-3">Logout</span>
                  </button>
                </div>
              </div>
              <div className="flex-1 flex flex-col overflow-hidden">
                <header className="bg-white shadow-sm p-4 flex justify-between items-center">
                  <h1 className="text-xl font-semibold text-gray-800">Welcome, {user.name}!</h1>
                  <span className="text-gray-500 cursor-pointer">🔔</span>
                </header>
                <main className="flex-1 overflow-x-hidden overflow-y-auto bg-gray-100 p-6">
                  {children}
                </main>
              </div>
            </div>
          );
        };

        // Admin Dashboard
        const AdminDashboard = ({ user, onLogout }) => {
          const [activeTab, setActiveTab] = useState('calendar');
          const TABS = [
            { id: 'calendar', name: 'Master Calendar', icon: '🗓️' },
            { id: 'vendors', name: 'Manage Vendors', icon: '💼' },
            { id: 'models', name: 'Manage Models', icon: '👥' },
            { id: 'logs', name: 'Transaction Logs', icon: '📄' },
          ];

          const renderTabContent = () => {
            switch (activeTab) {
              case 'vendors': return <ManageUsersTable title="Vendors" users={mockVendors} />;
              case 'models': return <ManageUsersTable title="Models" users={mockModels} />;
              case 'logs': return <TransactionLogs />;
              case 'calendar': default: return <MasterCalendar />;
            }
          };

          return (
            <DashboardLayout user={user} onLogout={onLogout} activeTab={activeTab} onTabChange={setActiveTab} tabs={TABS}>
              {renderTabContent()}
            </DashboardLayout>
          );
        };

        const ManageUsersTable = ({ title, users }) => (
            <Card>
                <h2 className="text-xl font-bold mb-4">{title}</h2>
                <div className="overflow-x-auto">
                    <table className="min-w-full bg-white">
                        <thead>
                            <tr className="w-full bg-gray-100 text-gray-600 uppercase text-sm leading-normal">
                                <th className="py-3 px-6 text-left">Name</th>
                                <th className="py-3 px-6 text-left">Email</th>
                                {users[0]?.company && <th className="py-3 px-6 text-left">Company</th>}
                                {users[0]?.phone && <th className="py-3 px-6 text-left">Phone</th>}
                                <th className="py-3 px-6 text-center">Actions</th>
                            </tr>
                        </thead>
                        <tbody className="text-gray-600 text-sm font-light">
                            {users.map(user => (
                                <tr key={user.id} className="border-b border-gray-200 hover:bg-gray-50">
                                    <td className="py-3 px-6 text-left whitespace-nowrap">{user.name}</td>
                                    <td className="py-3 px-6 text-left">{user.email}</td>
                                    {user.company && <td className="py-3 px-6 text-left">{user.company}</td>}
                                    {user.phone && <td className="py-3 px-6 text-left">{user.phone}</td>}
                                    <td className="py-3 px-6 text-center">
                                        <div className="flex item-center justify-center space-x-2">
                                            <button className="w-8 h-8 rounded-full bg-blue-100 text-blue-600 hover:bg-blue-200">✏️</button>
                                            <button className="w-8 h-8 rounded-full bg-red-100 text-red-600 hover:bg-red-200">🗑️</button>
                                        </div>
                                    </td>
                                </tr>
                            ))}
                        </tbody>
                    </table>
                </div>
            </Card>
        );

        const TransactionLogs = () => (
            <Card>
                <h2 className="text-xl font-bold mb-4">Transaction Logs</h2>
                <div className="space-y-3">
                    {mockLogs.map(log => (
                        <div key={log.id} className="p-3 bg-gray-50 rounded-lg border">
                            <p className="font-mono text-sm text-gray-500">{log.timestamp}</p>
                            <p className="font-semibold text-gray-800">{log.action}</p>
                            <p className="text-sm text-gray-600">{log.details}</p>
                        </div>
                    ))}
                </div>
            </Card>
        );

        const MasterCalendar = () => (
            <Card>
                <h2 className="text-xl font-bold mb-4">Master Appointment Calendar</h2>
                <p className="text-gray-600">This calendar shows all scheduled, pending, and past appointments across the platform.</p>
                <div className="mt-4 bg-gray-100 p-4 rounded-lg h-96">
                    <p className="text-center font-semibold">September 2025</p>
                    <div className="grid grid-cols-7 gap-2 mt-4 text-center text-sm">
                        <div>Sun</div><div>Mon</div><div>Tue</div><div>Wed</div><div>Thu</div><div>Fri</div><div>Sat</div>
                        {Array.from({ length: 30 }, (_, i) => (
                            <div key={i} className={`p-2 rounded-lg ${[14, 15].includes(i) ? 'bg-blue-200' : ''}`}>
                                {i + 1}
                            </div>
                        ))}
                    </div>
                    <div className="mt-4">
                        <h3 className="font-semibold">Upcoming:</h3>
                        <ul className="list-disc list-inside">
                            <li>Sep 15: Dr. Smith with C. Brown (Confirmed)</li>
                            <li>Sep 15: B. Johnson with D. Prince (Pending)</li>
                        </ul>
                    </div>
                </div>
            </Card>
        );


        // Vendor Dashboard
        const VendorDashboard = ({ user, onLogout }) => {
          const [activeTab, setActiveTab] = useState('schedule');
          const TABS = [
            { id: 'schedule', name: 'Schedule Scan', icon: '🗓️' },
            { id: 'appointments', name: 'My Appointments', icon: '💼' },
          ];

          const renderTabContent = () => {
            switch (activeTab) {
              case 'appointments':
                return <AppointmentList appointments={mockAppointments.filter(a => a.vendorId === 'v1')} userType="vendor" />;
              case 'schedule':
              default:
                return <ScheduleScanFlow />;
            }
          };

          return (
            <DashboardLayout user={user} onLogout={onLogout} activeTab={activeTab} onTabChange={setActiveTab} tabs={TABS}>
              {renderTabContent()}
            </DashboardLayout>
          );
        };

        const ScheduleScanFlow = () => {
            const [step, setStep] = useState(1);
            const [selection, setSelection] = useState({ date: '', time: '', applications: [] });
            const [selectedModels, setSelectedModels] = useState([]);
            const applications = ["Abdomen", "Vascular", "Breast", "Thyroid", "MSK", "Gynecology", "Bowel"];

            const handleAppToggle = (app) => {
                setSelection(prev => ({
                    ...prev,
                    applications: prev.applications.includes(app)
                        ? prev.applications.filter(a => a !== app)
                        : [...prev.applications, app]
                }));
            };

            const handleModelToggle = (modelId) => {
                setSelectedModels(prev =>
                    prev.includes(modelId)
                        ? prev.filter(id => id !== modelId)
                        : [...prev, modelId]
                );
            };

            const handleReset = () => {
                setStep(1);
                setSelection({ date: '', time: '', applications: [] });
                setSelectedModels([]);
            };

            return (
                <Card>
                    <h2 className="text-xl font-bold mb-4">Schedule a New Scan</h2>
                    {step === 1 && (
                        <div className="space-y-4">
                            <h3 className="font-semibold">Step 1: Select Date, Time, and Applications</h3>
                            <div className="grid md:grid-cols-2 gap-4">
                                <Input id="date" label="Date" type="date" value={selection.date} onChange={e => setSelection({...selection, date: e.target.value})} />
                                <Input id="time" label="Time" type="time" value={selection.time} onChange={e => setSelection({...selection, time: e.target.value})} />
                            </div>
                            <div>
                                <label className="block text-sm font-medium text-gray-700 mb-2">Applications</label>
                                <div className="grid grid-cols-2 md:grid-cols-4 gap-2">
                                    {applications.map(app => (
                                        <button key={app} onClick={() => handleAppToggle(app)} className={`p-2 rounded-lg text-sm border ${selection.applications.includes(app) ? 'bg-blue-600 text-white border-blue-600' : 'bg-white hover:bg-gray-50'}`}>
                                            {app}
                                        </button>
                                    ))}
                                </div>
                            </div>
                            <Button onClick={() => setStep(2)} className="w-full md:w-auto">Find Models</Button>
                        </div>
                    )}
                    {step === 2 && (
                        <div>
                            <h3 className="font-semibold mb-4">Step 2: Select Available Models</h3>
                            <p className="text-sm text-gray-600 mb-4">Showing models available for {selection.date || 'your selected date'} at {selection.time || 'your selected time'}.</p>
                            <div className="space-y-3">
                                {mockModels.filter(m => m.available).map(model => (
                                    <div key={model.id} className="flex items-center justify-between p-3 bg-gray-50 rounded-lg border">
                                        <div>
                                            <p className="font-bold">{model.name}</p>
                                            <p className="text-sm text-gray-500">{model.email}</p>
                                        </div>
                                        <Button
                                            onClick={() => handleModelToggle(model.id)}
                                            className={`text-sm ${selectedModels.includes(model.id) ? 'bg-green-600 hover:bg-green-700' : 'bg-blue-600 hover:bg-blue-700'}`}
                                        >
                                            {selectedModels.includes(model.id) ? '✓ Selected' : 'Select'}
                                        </Button>
                                    </div>
                                ))}
                            </div>
                            <div className="mt-6 flex justify-between">
                                <Button onClick={() => setStep(1)} className="bg-gray-600 hover:bg-gray-700">Back</Button>
                                <Button onClick={() => setStep(3)} disabled={selectedModels.length === 0}>
                                    Review Invite ({selectedModels.length})
                                </Button>
                            </div>
                        </div>
                    )}
                    {step === 3 && (
                         <div>
                            <h3 className="font-semibold mb-4">Step 3: Confirm and Send</h3>
                            <div className="p-4 bg-gray-50 rounded-lg border space-y-3 text-gray-700">
                                <div><strong>Date:</strong> {selection.date}</div>
                                <div><strong>Time:</strong> {selection.time}</div>
                                <div><strong>Applications:</strong> {selection.applications.join(', ')}</div>
                                <div><strong>Models to Invite:</strong></div>
                                <ul className="list-disc list-inside pl-4">
                                    {selectedModels.map(id => {
                                        const model = mockModels.find(m => m.id === id);
                                        return <li key={id}>{model.name} ({model.email})</li>;
                                    })}
                                </ul>
                            </div>
                             <p className="text-sm text-gray-600 my-4">You are about to send {selectedModels.length} invitation(s). Please confirm your selection.</p>
                            <div className="mt-6 flex justify-between">
                                 <Button onClick={() => setStep(2)} className="bg-gray-600 hover:bg-gray-700">Back</Button>
                                 <div className="flex space-x-3">
                                    <Button onClick={handleReset} className="bg-red-600 hover:bg-red-700">Cancel</Button>
                                    <Button onClick={handleReset} className="bg-green-600 hover:bg-green-700">Confirm & Send</Button>
                                 </div>
                            </div>
                        </div>
                    )}
                </Card>
            );
        };

        // Model Dashboard
        const ModelDashboard = ({ user, onLogout }) => {
          const [activeTab, setActiveTab] = useState('invites');
          const TABS = [
            { id: 'invites', name: 'Pending Invites', icon: '🔔' },
            { id: 'appointments', name: 'My Appointments', icon: '🗓️' },
            { id: 'profile', name: 'My Profile', icon: '👤' },
          ];
          
          const renderTabContent = () => {
              switch(activeTab) {
                  case 'appointments':
                      return <AppointmentList appointments={mockAppointments.filter(a => a.modelId === 'm2' || a.modelId === 'm1')} userType="model" />;
                  case 'profile':
                      return <ModelProfile />;
                  case 'invites':
                  default:
                      return <PendingInvites />;
              }
          };

          return (
            <DashboardLayout user={user} onLogout={onLogout} activeTab={activeTab} onTabChange={setActiveTab} tabs={TABS}>
              {renderTabContent()}
            </DashboardLayout>
          );
        };

        const PendingInvites = () => {
            const pending = mockAppointments.filter(a => a.status === 'pending');
            const [explanations, setExplanations] = useState({});
            const [isLoading, setIsLoading] = useState({});

            const getScanExplanation = async (inviteId, application) => {
                if (explanations[inviteId]) {
                    setExplanations(prev => ({...prev, [inviteId]: null}));
                    return;
                }

                setIsLoading(prev => ({ ...prev, [inviteId]: true }));
                const prompt = `In simple terms for a patient, what is a "${application}" ultrasound and how should I prepare for it? Keep it under 100 words.`;
                
                try {
                    const apiKey = "";
                    const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${apiKey}`;
                    
                    const payload = {
                        contents: [{ parts: [{ text: prompt }] }]
                    };

                    const response = await fetch(apiUrl, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(payload)
                    });

                    if (!response.ok) throw new Error("API Error");

                    const result = await response.json();
                    const text = result.candidates[0].content.parts[0].text;
                    setExplanations(prev => ({ ...prev, [inviteId]: text }));

                } catch (error) {
                    console.error("Error getting explanation:", error);
                    setExplanations(prev => ({ ...prev, [inviteId]: "Could not retrieve explanation at this time." }));
                } finally {
                    setIsLoading(prev => ({ ...prev, [inviteId]: false }));
                }
            };

            if (pending.length === 0) {
                return <Card><p>You have no pending invitations.</p></Card>
            }

            return (
                <div className="space-y-4">
                    {pending.map(invite => {
                        const vendor = mockVendors.find(v => v.id === invite.vendorId);
                        return (
                            <Card key={invite.id}>
                                <p className="font-bold text-lg">New Scan Invitation!</p>
                                <p className="mt-2 text-gray-700">
                                    Hi, <span className="font-semibold">{vendor.name}</span> at <span className="font-semibold">{vendor.company}</span> would like to meet you on <span className="font-semibold">{invite.date}</span> at <span className="font-semibold">{invite.time}</span> for {invite.duration} hours.
                                </p>
                                <p className="mt-1 text-gray-700">
                                    The requested scan is for: <span className="font-semibold">{invite.application}</span>.
                                </p>
                                
                                {explanations[invite.id] && (
                                    <div className="mt-4 p-3 bg-blue-50 border-l-4 border-blue-400 text-gray-700 rounded-r-lg">
                                        <h4 className="font-bold">What to Expect:</h4>
                                        <p className="text-sm whitespace-pre-wrap">{explanations[invite.id]}</p>
                                    </div>
                                )}

                                <div className="mt-4 flex flex-wrap gap-3">
                                    <Button className="bg-green-600 hover:bg-green-700">YES (Accept)</Button>
                                    <Button className="bg-red-600 hover:bg-red-700">NO (Reject)</Button>
                                    <Button onClick={() => getScanExplanation(invite.id, invite.application)} disabled={isLoading[invite.id]} className="bg-purple-600 hover:bg-purple-700">
                                        {isLoading[invite.id] ? <Spinner /> : <span className="mr-2">✨</span>}
                                        {explanations[invite.id] ? 'Hide Info' : 'What to Expect?'}
                                    </Button>
                                </div>
                            </Card>
                        );
                    })}
                </div>
            );
        };

        const ModelProfile = () => {
            const [profile, setProfile] = useState(mockModels[1]);

            const handleChange = (e) => {
                const { id, value } = e.target;
                setProfile(prevProfile => ({
                    ...prevProfile,
                    [id]: value,
                }));
            };

            const handleCheckboxChange = (e) => {
                setProfile(prevProfile => ({
                    ...prevProfile,
                    hasTransportation: e.target.checked,
                }));
            };

            return (
                <Card>
                    <h2 className="text-xl font-bold mb-4">My Profile</h2>
                    <div className="space-y-4">
                        <Input id="name" label="Full Name" value={profile.name} onChange={handleChange} />
                        <Input id="email" label="Email" value={profile.email} onChange={handleChange} />
                        <Input id="phone" label="Phone" value={profile.phone} onChange={handleChange} />
                        <div className="flex items-start">
                            <div className="flex items-center h-5">
                                <input 
                                    id="transportation" 
                                    name="transportation" 
                                    type="checkbox" 
                                    checked={profile.hasTransportation} 
                                    onChange={handleCheckboxChange} 
                                    className="focus:ring-blue-500 h-4 w-4 text-blue-600 border-gray-300 rounded" 
                                />
                            </div>
                            <div className="ml-3 text-sm">
                                <label htmlFor="transportation" className="font-medium text-gray-700">I have my own transportation</label>
                            </div>
                        </div>
                        <Button>Update Profile</Button>
                    </div>
                </Card>
            );
        };

        // Shared Component for Appointments
        const AppointmentList = ({ appointments, userType }) => {
            const getStatusChip = (status) => {
                switch (status) {
                    case 'confirmed': return <span className="px-2 py-1 text-xs font-semibold text-green-800 bg-green-100 rounded-full flex items-center gap-1">✅ Confirmed</span>;
                    case 'pending': return <span className="px-2 py-1 text-xs font-semibold text-yellow-800 bg-yellow-100 rounded-full flex items-center gap-1">🕒 Pending</span>;
                    case 'rejected': return <span className="px-2 py-1 text-xs font-semibold text-red-800 bg-red-100 rounded-full flex items-center gap-1">❌ Rejected</span>;
                    default: return <span className="px-2 py-1 text-xs font-semibold text-gray-800 bg-gray-100 rounded-full">{status}</span>;
                }
            };

            return (
                <Card>
                    <h2 className="text-xl font-bold mb-4">My Appointments</h2>
                    <div className="space-y-4">
                        {appointments.map(appt => {
                            const otherParty = userType === 'vendor'
                                ? mockModels.find(m => m.id === appt.modelId)
                                : mockVendors.find(v => v.id === appt.vendorId);
                            return (
                                <div key={appt.id} className="p-4 border rounded-lg bg-white flex flex-col sm:flex-row justify-between items-start sm:items-center gap-3">
                                    <div>
                                        <p className="font-bold text-gray-800">{appt.application} Scan</p>
                                        <p className="text-sm text-gray-600">
                                            With: <span className="font-semibold">{otherParty.name}</span> {userType === 'model' && `from ${otherParty.company}`}
                                        </p>
                                        <p className="text-sm text-gray-500">{appt.date} @ {appt.time}</p>
                                    </div>
                                    {getStatusChip(appt.status)}
                                </div>
                            );
                        })}
                    </div>
                </Card>
            );
        };

        const container = document.getElementById('root');
        const root = ReactDOM.createRoot(container);
        root.render(<App />);

    </script>

</body>
</html>